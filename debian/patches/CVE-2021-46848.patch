From: Simon Josefsson <simon@josefsson.org>
Date: Wed, 17 Aug 2022 12:25:06 +0200
Subject: [PATCH] Fix ETYPE_OK off by one array size check.  Closes: #32

Reported by David Trabish in
<https://gitlab.com/gnutls/libtasn1/-/issues/32>.

Signed-off-by: Simon Josefsson <simon@josefsson.org>
---
 lib/int.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: libtasn1-6-4.2/lib/int.h
===================================================================
--- libtasn1-6-4.2.orig/lib/int.h	2023-05-27 18:41:44.652585686 +0200
+++ libtasn1-6-4.2/lib/int.h	2023-05-27 18:42:51.608642084 +0200
@@ -99,7 +99,7 @@
 #define ETYPE_TAG(etype) (_asn1_tags[etype].tag)
 #define ETYPE_CLASS(etype) (_asn1_tags[etype].class)
 #define ETYPE_OK(etype) ((etype != ASN1_ETYPE_INVALID && \
-                          etype <= _asn1_tags_size && \
+                          (etype) < _asn1_tags_size && \
                           _asn1_tags[etype].desc != NULL)?1:0)
 
 extern unsigned int _asn1_tags_size;
